# Module 02: Lane Keeping Assist System - ê²€ì¦ì„œ

**ë²„ì „:** 1.0  
**ì‘ì„±ì¼:** 2026-01-30  
**ìƒíƒœ:** ê²€ì¦ ê³„íš

---

## ğŸ“‹ ëª©ì°¨

1. [ê²€ì¦ ê°œìš”](#1-ê²€ì¦-ê°œìš”)
2. [ì„±ëŠ¥ ëª©í‘œ (KPI)](#2-ì„±ëŠ¥-ëª©í‘œ-kpi)
3. [ê²€ì¦ í™˜ê²½](#3-ê²€ì¦-í™˜ê²½)
4. [ë‹¨ìœ„ í…ŒìŠ¤íŠ¸](#4-ë‹¨ìœ„-í…ŒìŠ¤íŠ¸)
5. [í†µí•© í…ŒìŠ¤íŠ¸](#5-í†µí•©-í…ŒìŠ¤íŠ¸)
6. [ì„±ëŠ¥ í…ŒìŠ¤íŠ¸](#6-ì„±ëŠ¥-í…ŒìŠ¤íŠ¸)
7. [ì•ˆì „ í…ŒìŠ¤íŠ¸](#7-ì•ˆì „-í…ŒìŠ¤íŠ¸)
8. [ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸](#8-ì‹œë®¬ë ˆì´ì…˜-í…ŒìŠ¤íŠ¸)
9. [ì‹¤ì°¨ í…ŒìŠ¤íŠ¸](#9-ì‹¤ì°¨-í…ŒìŠ¤íŠ¸)
10. [ê²€ì¦ ê²°ê³¼ ë³´ê³ ](#10-ê²€ì¦-ê²°ê³¼-ë³´ê³ )

---

## 1. ê²€ì¦ ê°œìš”

### 1.1 ëª©ì 

Module 02 (Lane Keeping Assist)ê°€ ì•„í‚¤í…ì²˜ ì„¤ê³„ì„œì™€ êµ¬í˜„ ëª…ì„¸ì„œì— ëª…ì‹œëœ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.

### 1.2 ê²€ì¦ ë²”ìœ„

**In Scope:**
- âœ… ê¸°ëŠ¥ ê²€ì¦: ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ëª…ì„¸ëŒ€ë¡œ ë™ì‘
- âœ… ì„±ëŠ¥ ê²€ì¦: KPI ëª©í‘œ ë‹¬ì„± ì—¬ë¶€
- âœ… ì•ˆì „ ê²€ì¦: Fail-safe ë©”ì»¤ë‹ˆì¦˜ ë™ì‘
- âœ… í†µí•© ê²€ì¦: Module 01ê³¼ì˜ ì—°ë™

**Out of Scope:**
- âŒ í•˜ë“œì›¨ì–´ ìˆ˜ì¤€ ê²€ì¦ (CAN í†µì‹  ë“±)
- âŒ ë²•ê·œ ì í•©ì„± ê²€ì¦ (ISO 11270)
- âŒ ëŒ€ê·œëª¨ ì‹¤ë„ë¡œ í…ŒìŠ¤íŠ¸

### 1.3 ê²€ì¦ ì „ëµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 4: Real-World Test                   â”‚
â”‚  - PiRacer ì‹¤ì°¨ í…ŒìŠ¤íŠ¸                        â”‚
â”‚  - ì‹¤ì œ íŠ¸ë™ ì£¼í–‰                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 3: Simulation Test                   â”‚
â”‚  - CARLA / Gazebo ì‹œë®¬ë ˆì´ì…˜                  â”‚
â”‚  - ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 2: Integration Test                  â”‚
â”‚  - Module 01 + Module 02 E2E                â”‚
â”‚  - ë…¹í™”ëœ ë¹„ë””ì˜¤ë¡œ í…ŒìŠ¤íŠ¸                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Level 1: Unit Test                         â”‚
â”‚  - ê°œë³„ ì»´í¬ë„ŒíŠ¸ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸                    â”‚
â”‚  - Mock ë°ì´í„° ì‚¬ìš©                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ì„±ëŠ¥ ëª©í‘œ (KPI)

### 2.1 ì •ëŸ‰ì  KPI

| ë©”íŠ¸ë¦­ | ëª©í‘œ | ì¸¡ì • ë°©ë²• | ìš°ì„ ìˆœìœ„ |
|--------|------|-----------|---------|
| **ì²˜ë¦¬ ì§€ì—°ì‹œê°„** | < 25ms | Frame-to-command | P0 (í•„ìˆ˜) |
| **ì°¨ì„  ì¤‘ì‹¬ ì¶”ì • MAE** | < 10cm | Ground truth ëŒ€ë¹„ | P0 |
| **ì´íƒˆ ê°ì§€ Precision** | > 95% | TP/(TP+FP) | P0 |
| **ì´íƒˆ ê°ì§€ Recall** | > 98% | TP/(TP+FN) | P0 |
| **False Warning Rate** | < 1 per 100km | ì‹¤ì£¼í–‰ ê¸°ë¡ | P1 (ê¶Œì¥) |
| **ì¡°í–¥ ì•ˆì •ì„± (Jerk)** | < 2Â°/sÂ² | ì¡°í–¥ê° 2ì°¨ ë¯¸ë¶„ | P1 |
| **CPU ì‚¬ìš©ë¥ ** | < 30% | ë‹¨ì¼ ì½”ì–´ | P2 (ì„ íƒ) |
| **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰** | < 100MB | RSS | P2 |

### 2.2 ì •ì„±ì  ëª©í‘œ

| í•­ëª© | ê¸°ì¤€ | í‰ê°€ ë°©ë²• |
|------|------|-----------|
| **ë¶€ë“œëŸ¬ìš´ ì œì–´** | ì‚¬ìš©ì ë¶ˆí¸ ì—†ìŒ | ì£¼ê´€ì  í‰ê°€ (5ì  ì²™ë„) |
| **ì˜ˆì¸¡ ê°€ëŠ¥ì„±** | ì‹œìŠ¤í…œ ë™ì‘ ì˜ˆì¸¡ ê°€ëŠ¥ | ì‚¬ìš©ì ì„¤ë¬¸ |
| **íˆ¬ëª…ì„±** | ê²°ì • ê³¼ì • ì¶”ì  ê°€ëŠ¥ | ë¡œê·¸ ë¶„ì„ |
| **ê°•ê±´ì„±** | ë‹¤ì–‘í•œ ì¡°ê±´ì—ì„œ ì•ˆì • | ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ |

---

## 3. ê²€ì¦ í™˜ê²½

### 3.1 í•˜ë“œì›¨ì–´

**ê°œë°œ í™˜ê²½:**
- CPU: Intel i7 ë˜ëŠ” ë™ê¸‰
- RAM: 16GB+
- GPU: ë¶ˆí•„ìš” (Module 01ì—ì„œë§Œ ì‚¬ìš©)
- OS: Ubuntu 22.04 / macOS / Windows 10+

**ì‹¤ì°¨ í™˜ê²½ (PiRacer):**
- SBC: Raspberry Pi 4B (4GB RAM)
- Camera: Pi Camera V2 (1080p)
- Motor: DC Motor + Servo
- Power: 2S LiPo Battery

### 3.2 ì†Œí”„íŠ¸ì›¨ì–´

```yaml
Python: 3.10+
Packages:
  - pytest: 7.4+
  - pytest-cov: 4.1+
  - pytest-benchmark: 4.0+
  - numpy: 1.24+
  - scipy: 1.10+
  - opencv-python: 4.8+
```

### 3.3 í…ŒìŠ¤íŠ¸ ë°ì´í„°

**í•©ì„± ë°ì´í„°:**
- ì§ì„  ì°¨ì„ : 100 samples
- ê³¡ì„  ì°¨ì„ : 100 samples
- ì´íƒˆ ì‹œë‚˜ë¦¬ì˜¤: 50 samples

**ì‹¤ì œ ë°ì´í„°:**
- Module 01 ì¶œë ¥ (ë…¹í™”): 500 frames
- PiRacer ì£¼í–‰ ì˜ìƒ: 10ë¶„

---

## 4. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

### 4.1 `LaneTracker` í…ŒìŠ¤íŠ¸

**íŒŒì¼:** `tests/test_lane_tracker.py`

#### Test Case 1: ì •ìƒ ì¶”ì 
```python
def test_lane_tracker_normal():
    """ì •ìƒì ì¸ ì°¨ì„  ì¶”ì  í…ŒìŠ¤íŠ¸"""
    tracker = LaneTracker()
    
    # ì§ì„  ì°¨ì„  polyline
    polyline = [(320, i) for i in range(100, 480, 10)]
    confidence = 0.95
    
    result = tracker.track(polyline, confidence)
    
    # ê²€ì¦
    assert result["is_valid"] == True
    assert abs(result["lateral_offset"]) < 0.05  # 5cm ì´ë‚´
    assert abs(result["heading_error"]) < 1.0    # 1ë„ ì´ë‚´
    assert abs(result["curvature"]) < 0.01       # ì§ì„ 
```

#### Test Case 2: ë‚®ì€ ì‹ ë¢°ë„
```python
def test_lane_tracker_low_confidence():
    """ë‚®ì€ ì‹ ë¢°ë„ ì…ë ¥ ì²˜ë¦¬"""
    tracker = LaneTracker(min_confidence=0.5)
    
    polyline = [(320, i) for i in range(100, 480, 10)]
    confidence = 0.3  # ë‚®ì€ ì‹ ë¢°ë„
    
    result = tracker.track(polyline, confidence)
    
    # ê²€ì¦
    assert result["is_valid"] == False
    assert "reason" in result
```

#### Test Case 3: ê³¡ì„  ì°¨ì„ 
```python
def test_lane_tracker_curve():
    """ê³¡ì„  ì°¨ì„  ì¶”ì """
    tracker = LaneTracker()
    
    # ì›í˜• ê³¡ì„  ìƒì„±
    center = (320, 240)
    radius = 200
    polyline = [
        (center[0] + radius * np.cos(theta),
         center[1] + radius * np.sin(theta))
        for theta in np.linspace(-np.pi/2, np.pi/2, 30)
    ]
    
    result = tracker.track(polyline, 0.9)
    
    # ê²€ì¦
    assert result["is_valid"] == True
    assert result["curvature"] != 0.0  # ê³¡ë¥  ì¡´ì¬
    assert abs(result["curvature"] - 1/radius) < 0.01  # ì´ë¡ ê°’ê³¼ ê·¼ì‚¬
```

#### Test Case 4: ë¶ˆì¶©ë¶„í•œ ì 
```python
def test_lane_tracker_insufficient_points():
    """í¬ì¸íŠ¸ ë¶€ì¡± ì²˜ë¦¬"""
    tracker = LaneTracker()
    
    polyline = [(320, 240), (320, 250)]  # 2ê°œë§Œ
    
    result = tracker.track(polyline, 0.9)
    
    # ê²€ì¦
    assert result["is_valid"] == False
```

**ì»¤ë²„ë¦¬ì§€ ëª©í‘œ:** > 90%

### 4.2 `DepartureDetector` í…ŒìŠ¤íŠ¸

**íŒŒì¼:** `tests/test_departure_detector.py`

#### Test Case 5: ì•ˆì „ ì£¼í–‰
```python
def test_departure_detector_safe():
    """ì•ˆì „ ì£¼í–‰ ìƒíƒœ"""
    detector = DepartureDetector()
    
    result = detector.detect(
        lateral_offset=0.1,   # 10cm
        heading_error=2.0,    # 2ë„
        vehicle_speed=60.0,   # 60 km/h
        timestamp=0.0
    )
    
    # ê²€ì¦
    assert result["is_departing"] == False
    assert result["risk_level"] == 0
    assert result["departure_side"] == "right"
```

#### Test Case 6: ê²½ê³  ë ˆë²¨
```python
def test_departure_detector_warning():
    """ê²½ê³  ë ˆë²¨ ì´íƒˆ"""
    detector = DepartureDetector()
    
    result = detector.detect(
        lateral_offset=0.7,   # 70cm
        heading_error=12.0,   # 12ë„
        vehicle_speed=80.0,
        timestamp=0.0
    )
    
    # ê²€ì¦
    assert result["is_departing"] == True
    assert result["risk_level"] == 3  # Warning
    assert result["time_to_crossing"] < 5.0  # TTC < 5ì´ˆ
```

#### Test Case 7: ê¸´ê¸‰ ìƒí™©
```python
def test_departure_detector_emergency():
    """ê¸´ê¸‰ ì´íƒˆ ìƒí™©"""
    detector = DepartureDetector()
    
    result = detector.detect(
        lateral_offset=1.2,   # 120cm (ì°¨ì„  í­ ì´ˆê³¼)
        heading_error=25.0,   # 25ë„
        vehicle_speed=100.0,
        timestamp=0.0
    )
    
    # ê²€ì¦
    assert result["is_departing"] == True
    assert result["risk_level"] == 5  # Emergency
    assert result["time_to_crossing"] < 1.0  # ì¦‰ì‹œ
```

**ì»¤ë²„ë¦¬ì§€ ëª©í‘œ:** > 95%

### 4.3 `PIDController` í…ŒìŠ¤íŠ¸

**íŒŒì¼:** `tests/test_pid_controller.py`

#### Test Case 8: P ì œì–´
```python
def test_pid_controller_proportional():
    """ë¹„ë¡€ ì œì–´ í…ŒìŠ¤íŠ¸"""
    controller = PIDController(
        params=PIDParams(kp=1.0, ki=0.0, kd=0.0)
    )
    
    steering = controller.compute(
        lateral_offset=0.5,
        heading_error=0.0
    )
    
    # P ì œì–´ë§Œ: steering = kp * error
    expected = 1.0 * 0.5  # kp * offset
    assert abs(steering - expected) < 0.01
```

#### Test Case 9: ì ë¶„ ëˆ„ì 
```python
def test_pid_controller_integral():
    """ì ë¶„ ì œì–´ í…ŒìŠ¤íŠ¸"""
    params = PIDParams(kp=0.0, ki=1.0, kd=0.0)
    controller = PIDController(params, dt=0.1)
    
    # 10ìŠ¤í… ë™ì•ˆ error=0.1 ìœ ì§€
    for _ in range(10):
        steering = controller.compute(0.1, 0.0)
    
    # I term = ki * âˆ«error dt = 1.0 * (0.1 * 0.1 * 10) = 0.1
    expected = 1.0 * (0.1 * 0.1 * 10)
    assert abs(steering - expected) < 0.01
```

#### Test Case 10: Anti-windup
```python
def test_pid_controller_antiwindup():
    """Anti-windup í…ŒìŠ¤íŠ¸"""
    params = PIDParams(kp=0.0, ki=1.0, kd=0.0, windup_limit=1.0)
    controller = PIDController(params, dt=0.1)
    
    # í° ì—ëŸ¬ë¡œ ì ë¶„ í¬í™”ì‹œí‚¤ê¸°
    for _ in range(100):
        controller.compute(10.0, 0.0)
    
    # ì ë¶„ê°’ì´ windup_limitìœ¼ë¡œ ì œí•œë˜ì–´ì•¼ í•¨
    assert abs(controller._integral) <= params.windup_limit
```

#### Test Case 11: ì¡°í–¥ê° ì œí•œ
```python
def test_pid_controller_steering_limit():
    """ì¡°í–¥ê° ì œí•œ í…ŒìŠ¤íŠ¸"""
    controller = PIDController()
    
    # ë§¤ìš° í° ì—ëŸ¬
    steering = controller.compute(100.0, 100.0)
    
    # ìµœëŒ€ ì¡°í–¥ê° ì´ë‚´
    assert abs(steering) <= controller.params.max_steering_angle
```

**ì»¤ë²„ë¦¬ì§€ ëª©í‘œ:** > 95%

### 4.4 `WarningSystem` í…ŒìŠ¤íŠ¸

**íŒŒì¼:** `tests/test_warning_system.py`

#### Test Case 12: ë ˆë²¨ë³„ ê²½ê³ 
```python
@pytest.mark.parametrize("risk_level,expected_visual,expected_audio", [
    (0, False, False),  # Safe
    (1, False, False),  # Normal
    (2, True, False),   # Caution (ì‹œê°ë§Œ)
    (3, True, True),    # Warning (ì‹œê°+ì²­ê°)
    (4, True, True),    # Critical (ì‹œê°+ì²­ê°+í–…í‹±)
    (5, True, True),    # Emergency (ëª¨ë‘)
])
def test_warning_system_levels(risk_level, expected_visual, expected_audio):
    """ìœ„í—˜ë„ë³„ ê²½ê³  í™œì„±í™”"""
    warning_system = WarningSystem()
    
    warning_system.update(risk_level, "right")
    
    assert warning_system.is_visual_active() == expected_visual
    assert warning_system.is_audio_active() == expected_audio
```

**ì»¤ë²„ë¦¬ì§€ ëª©í‘œ:** > 90%

---

## 5. í†µí•© í…ŒìŠ¤íŠ¸

### 5.1 E2E íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸

**íŒŒì¼:** `tests/test_integration.py`

#### Test Case 13: ì „ì²´ íŒŒì´í”„ë¼ì¸
```python
def test_e2e_pipeline():
    """Module 01 â†’ Module 02 ì „ì²´ í”Œë¡œìš°"""
    # Module 01 Mock ì¶œë ¥
    lane_detection_output = {
        "lane_polyline": [(320, i) for i in range(100, 480, 10)],
        "confidence": 0.95
    }
    
    # Module 02 ì´ˆê¸°í™”
    lkas = LaneKeepingAssist(config_path="config/lkas_params.yaml")
    
    # ì²˜ë¦¬
    result = lkas.process_frame(
        lane_detection=lane_detection_output,
        vehicle_state={"speed": 60.0}
    )
    
    # ê²€ì¦
    assert "steering_angle" in result
    assert "warning_level" in result
    assert result["is_intervening"] == False  # ì •ìƒ ì£¼í–‰
```

#### Test Case 14: ì´íƒˆ ì‹œë‚˜ë¦¬ì˜¤
```python
def test_e2e_departure_scenario():
    """ì´íƒˆ ì‹œë‚˜ë¦¬ì˜¤ í†µí•© í…ŒìŠ¤íŠ¸"""
    # ì°¨ì„ ì´ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì¹˜ìš°ì¹œ ì…ë ¥
    lane_detection_output = {
        "lane_polyline": [(400, i) for i in range(100, 480, 10)],  # ì˜¤ë¥¸ìª½
        "confidence": 0.9
    }
    
    lkas = LaneKeepingAssist()
    result = lkas.process_frame(lane_detection_output, {"speed": 60.0})
    
    # ê²€ì¦
    assert result["warning_level"] >= 2  # ê²½ê³  ë°œìƒ
    assert result["is_intervening"] == True  # ê°œì… ì‹œì‘
    assert result["steering_angle"] < 0  # ì™¼ìª½ìœ¼ë¡œ ì¡°í–¥
```

---

## 6. ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### 6.1 ì²˜ë¦¬ ì‹œê°„ ë²¤ì¹˜ë§ˆí¬

```python
def test_benchmark_latency(benchmark):
    """ì²˜ë¦¬ ì§€ì—°ì‹œê°„ ë²¤ì¹˜ë§ˆí¬"""
    lkas = LaneKeepingAssist()
    
    lane_detection = {
        "lane_polyline": [(320, i) for i in range(100, 480, 10)],
        "confidence": 0.95
    }
    vehicle_state = {"speed": 60.0}
    
    # ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
    result = benchmark(lkas.process_frame, lane_detection, vehicle_state)
    
    # ê²€ì¦: < 25ms
    assert benchmark.stats['mean'] < 0.025  # 25ms
```

### 6.2 ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

```python
import psutil
import os

def test_memory_usage():
    """ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¸¡ì •"""
    process = psutil.Process(os.getpid())
    mem_before = process.memory_info().rss / 1024 / 1024  # MB
    
    # LKAS ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° 100 í”„ë ˆì„ ì²˜ë¦¬
    lkas = LaneKeepingAssist()
    for _ in range(100):
        lane_detection = {
            "lane_polyline": [(320, i) for i in range(100, 480, 10)],
            "confidence": 0.95
        }
        lkas.process_frame(lane_detection, {"speed": 60.0})
    
    mem_after = process.memory_info().rss / 1024 / 1024  # MB
    mem_used = mem_after - mem_before
    
    # ê²€ì¦: < 100MB
    assert mem_used < 100
```

---

## 7. ì•ˆì „ í…ŒìŠ¤íŠ¸

### 7.1 Fail-Safe í…ŒìŠ¤íŠ¸

```python
def test_failsafe_low_confidence():
    """ë‚®ì€ ì‹ ë¢°ë„ ì…ë ¥ ì‹œ ì•ˆì „ ëª¨ë“œ"""
    lkas = LaneKeepingAssist()
    
    lane_detection = {
        "lane_polyline": [(320, i) for i in range(100, 480, 10)],
        "confidence": 0.2  # ë‚®ì€ ì‹ ë¢°ë„
    }
    
    result = lkas.process_frame(lane_detection, {"speed": 60.0})
    
    # ê°œì… ì¤‘ë‹¨, ê²½ê³ ë§Œ ìœ ì§€
    assert result["is_intervening"] == False
    assert result["steering_angle"] == 0.0
```

### 7.2 Watchdog í…ŒìŠ¤íŠ¸

```python
import threading
import time

def test_watchdog_timeout():
    """Watchdog timeout í…ŒìŠ¤íŠ¸"""
    lkas = LaneKeepingAssist()
    
    # ì²˜ë¦¬ ì‹œê°„ì´ ê¸´ í•¨ìˆ˜ë¡œ ë¸”ë¡œí‚¹
    def slow_process():
        time.sleep(1.0)  # 1ì´ˆ ì§€ì—°
    
    # Watchdog í™œì„±í™” (timeout=0.1ì´ˆ)
    with pytest.raises(TimeoutError):
        lkas._execute_with_watchdog(slow_process, timeout=0.1)
```

---

## 8. ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸

### 8.1 CARLA ì‹œë®¬ë ˆì´ì…˜

**ì‹œë‚˜ë¦¬ì˜¤ 1: ê³ ì†ë„ë¡œ ì§ì„  ì£¼í–‰**
```yaml
Scenario:
  Name: "Highway Straight Lane"
  Road: Highway, 3 lanes
  Vehicle Speed: 80-120 km/h
  Duration: 5 minutes
  
Expected:
  - ì°¨ì„  ìœ ì§€ìœ¨: > 99%
  - False Warning: 0íšŒ
  - í‰ê·  íš¡ë°©í–¥ ì˜¤í”„ì…‹: < 10cm
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: ì»¤ë¸Œ ë„ë¡œ**
```yaml
Scenario:
  Name: "Curved Road"
  Road: ë°˜ê²½ 200-500m ì»¤ë¸Œ
  Vehicle Speed: 60-80 km/h
  Duration: 3 minutes
  
Expected:
  - ì°¨ì„  ìœ ì§€ìœ¨: > 95%
  - ìµœëŒ€ íš¡ë°©í–¥ ì˜¤í”„ì…‹: < 30cm
  - ì¡°í–¥ Jerk: < 2Â°/sÂ²
```

**ì‹œë‚˜ë¦¬ì˜¤ 3: ì°¨ì„  í¬ë¯¸í•œ êµ¬ê°„**
```yaml
Scenario:
  Name: "Faded Lane Markings"
  Road: ì°¨ì„  í‘œì‹œ í¬ë¯¸ (confidence < 0.6)
  Vehicle Speed: 60 km/h
  Duration: 2 minutes
  
Expected:
  - Fail-safe í™œì„±í™”
  - ê°œì… ì¤‘ë‹¨
  - ê²½ê³  ë°œìƒ
```

---

## 9. ì‹¤ì°¨ í…ŒìŠ¤íŠ¸

### 9.1 PiRacer í…ŒìŠ¤íŠ¸ ì ˆì°¨

**ì¤€ë¹„ ë‹¨ê³„:**
1. PiRacer í•˜ë“œì›¨ì–´ ê²€ì‚¬
2. ë°°í„°ë¦¬ ì¶©ì „ í™•ì¸
3. ì¹´ë©”ë¼ ìº˜ë¦¬ë¸Œë ˆì´ì…˜
4. í†µì‹  í…ŒìŠ¤íŠ¸

**í…ŒìŠ¤íŠ¸ íŠ¸ë™:**
- ì‹¤ë‚´ RC íŠ¸ë™
- ì°¨ì„  í­: 30-40cm
- íŠ¸ë™ ê¸¸ì´: 10-20m

**ì¸¡ì • í•­ëª©:**
- ì£¼í–‰ ì„±ê³µë¥  (ì™„ì£¼ ë¹„ìœ¨)
- ì°¨ì„  ì´íƒˆ íšŸìˆ˜
- í‰ê·  ì†ë„
- ë°˜ì‘ ì‹œê°„

**ì•ˆì „ ì¡°ì¹˜:**
- ë¹„ìƒ ì •ì§€ ë²„íŠ¼ ì¤€ë¹„
- ìµœëŒ€ ì†ë„ ì œí•œ (30% throttle)
- ê´€ì°°ì ë°°ì¹˜

---

## 10. ê²€ì¦ ê²°ê³¼ ë³´ê³ 

### 10.1 ë³´ê³ ì„œ êµ¬ì¡°

```markdown
# Module 02 ê²€ì¦ ë³´ê³ ì„œ

## ìš”ì•½
- í…ŒìŠ¤íŠ¸ ì¼ì: YYYY-MM-DD
- í…ŒìŠ¤íŠ¸ í™˜ê²½: [í™˜ê²½ ì •ë³´]
- ì „ì²´ Pass Rate: XX%

## ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- ì´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: XXê°œ
- Pass: XXê°œ
- Fail: XXê°œ
- ì»¤ë²„ë¦¬ì§€: XX%

## ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- í‰ê·  ì²˜ë¦¬ ì‹œê°„: XX ms
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: XX MB
- CPU ì‚¬ìš©ë¥ : XX%

## ì•ˆì „ í…ŒìŠ¤íŠ¸
- Fail-safe ë™ì‘: Pass/Fail
- Watchdog ë™ì‘: Pass/Fail

## ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸
- ì‹œë‚˜ë¦¬ì˜¤ 1: Pass/Fail
- ì‹œë‚˜ë¦¬ì˜¤ 2: Pass/Fail
...

## ì‹¤ì°¨ í…ŒìŠ¤íŠ¸
- ì£¼í–‰ ì„±ê³µë¥ : XX%
- ì´íƒˆ íšŸìˆ˜: XXíšŒ
...

## ê²°ë¡ 
- KPI ë‹¬ì„±ë¥ : XX%
- ê°œì„  í•„ìš” ì‚¬í•­: [ë¦¬ìŠ¤íŠ¸]
- ìµœì¢… íŒì •: Pass/Fail
```

---

**ë‹¤ìŒ ë‹¨ê³„:** ì‹¤ì œ êµ¬í˜„ í›„ ì´ ê²€ì¦ ê³„íšì— ë”°ë¼ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰

**ì‘ì„±ì:** [ì´ë¦„]  
**ë¦¬ë·°ì–´:** [ì´ë¦„]  
**ìŠ¹ì¸ì:** [ì´ë¦„]
